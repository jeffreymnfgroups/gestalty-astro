---
import { markdownify } from "@/lib/utils/textConverter";
import type { CollectionEntry } from "astro:content";
import { getEntry } from "astro:content";

const {
  title,
  subtitle,
  description,
  framework_title,
  framework_content,
  transformation_title,
  transformations,
  beyond_content,
} = (
  (await getEntry(
    "theSolutionSection",
    "the-solution"
  )) as CollectionEntry<"theSolutionSection">
).data;
---

<section class="section">
  <div class="container">
    <div class="row">
      <div class="mx-auto text-center lg:col-10" data-aos="fade-up-sm">
        {
          subtitle && (
            <p
              class="mb-2 font-medium text-tertiary"
              set:html={markdownify(subtitle)}
            />
          )
        }
        {title && <h2 class="mb-6" set:html={markdownify(title)} />}
        {
          description && (
            <p class="text-lg/[inherit]" set:html={markdownify(description)} />
          )
        }
      </div>
      <div class="col-12 pt-16">
        {
          framework_title && framework_content && (
            <div class="row">
              <div class="mx-auto lg:col-10" data-aos="fade-up-sm">
                <div class="rounded-xl bg-light p-8 md:rounded-3xl md:p-12">
                  <h3 class="h4 mb-4" set:html={markdownify(framework_title)} />
                  <p class="text-lg/[inherit] mb-0" set:html={markdownify(framework_content)} />
                </div>
              </div>
            </div>
          )
        }
        {
          transformation_title && transformations && (
            <div class="row pt-16">
              <div class="mx-auto lg:col-10" data-aos="fade-up-sm" data-aos-delay="100">
                <h3 class="h4 mb-8 text-center" set:html={markdownify(transformation_title)} />
                <div class="overflow-x-auto">
                  <table class="w-full min-w-[500px] rounded-xl bg-light overflow-hidden">
                    <thead class="bg-tertiary text-text-light">
                      <tr>
                        <th class="px-6 py-4 text-left font-semibold">Transformation</th>
                        <th class="px-6 py-4 text-left font-semibold">Impact</th>
                      </tr>
                    </thead>
                    <tbody>
                      {transformations.map((item, index) => (
                        <tr class={index % 2 === 0 ? "bg-white" : ""}>
                          <td class="px-6 py-4" set:html={markdownify(item.transformation)} />
                          <td class="px-6 py-4" set:html={markdownify(item.impact)} />
                        </tr>
                      ))}
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          )
        }
        {
          beyond_content && (
            <div class="row pt-16">
              <div class="mx-auto lg:col-10" data-aos="fade-up-sm" data-aos-delay="200">
                <div class="rounded-xl bg-tertiary p-8 text-center text-text-light md:rounded-3xl md:p-12">
                  <p class="text-lg/[inherit] mb-0 text-inherit" set:html={markdownify(beyond_content)} />
                </div>
              </div>
            </div>
          )
        }
      </div>
    </div>
  </div>
</section>

